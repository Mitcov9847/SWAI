# Лабораторная работа №3  
**Мониторинг ИТ-инфраструктуры с использованием Zabbix**  

---

## Цель работы
Целью данной работы является ознакомление студентов с системой Zabbix для мониторинга серверов, сервисов и сетевого оборудования. В ходе работы студенты изучают установку и настройку Zabbix, добавление хостов, настройку сбора метрик, создание триггеров и оповещений, а также создание персональной панели мониторинга (Dashboard).

---

## Задачи
1. Установить и настроить сервер Zabbix.  
2. Установить агент Zabbix на контролируемую машину.  
3. Добавить и настроить хост в системе.  
4. Просмотреть собираемые метрики и создать оповещения.  

---

## Необходимое оборудование и программное обеспечение
- Две виртуальные машины (например, Ubuntu Server 22.04).  
- Доступ в Интернет.  
- Zabbix Server + MySQL + Apache/Nginx.  
- Zabbix Agent.  

---

## Ход работы

### 1. Установка и настройка сервера Zabbix
Для начала работы требуется подготовить виртуальную машину с Ubuntu 22.04. После обновления системы выполняем установку Zabbix:  

```bash
wget https://repo.zabbix.com/zabbix/6.4/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.4-1+ubuntu22.04_all.deb
sudo dpkg -i zabbix-release_6.4-1+ubuntu22.04_all.deb
sudo apt update
sudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent -y
```

> **Пояснение:**  
> - Zabbix Server — основной компонент для сбора и обработки данных.  
> - Frontend (веб-интерфейс) позволяет визуализировать метрики.  
> - Apache/Nginx используется для отображения веб-интерфейса.  
> - MySQL хранит все метрики и конфигурации.

**Место для скриншота 1:** установка Zabbix сервера  

---

### 2. Настройка базы данных и веб-интерфейса
Создаем базу данных для Zabbix и пользователя:  

```bash
sudo mysql -uroot -p
CREATE DATABASE zabbix character set utf8mb4 collate utf8mb4_bin;
CREATE USER 'zabbix'@'localhost' IDENTIFIED BY 'zabbix_password';
GRANT ALL PRIVILEGES ON zabbix.* TO 'zabbix'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

Импортируем схему базы данных:

```bash
zcat /usr/share/doc/zabbix-sql-scripts/mysql/create.sql.gz | mysql -uzabbix -pzabbix_password zabbix
```

Настраиваем конфигурацию Zabbix сервера (`/etc/zabbix/zabbix_server.conf`), указывая логин и пароль к базе данных.

> **Пояснение:**  
> Database (MySQL) хранит все данные о метриках, триггерах и пользователях.  

**Место для скриншота 2:** веб-интерфейс Zabbix при первом запуске  

---

### 3. Установка Zabbix Agent на другой машине
На контролируемой машине устанавливаем Zabbix Agent:  

```bash
sudo apt install zabbix-agent -y
sudo systemctl enable zabbix-agent
sudo systemctl start zabbix-agent
sudo systemctl status zabbix-agent
```

> **Пояснение:**  
> Zabbix Agent собирает метрики с сервера или рабочего места и отправляет их на Zabbix Server.  
> Связь может быть активной (Agent отправляет данные серверу) или пассивной (сервер опрашивает агент).  

**Место для скриншота 3:** статус Zabbix Agent  

---

### 4. Добавление хоста в веб-интерфейсе Zabbix
В интерфейсе Zabbix переходим в `Configuration → Hosts → Create host` и добавляем контролируемую машину.  

- Host name: `jenia-desktop`  
- Groups: `Linux servers`  
- Interfaces: IP 127.0.0.1, порт 10050  
- Templates: `Linux by Zabbix agent`  

> **Пояснение:**  
> Host — это объект мониторинга. Templates позволяют быстро добавить набор Items (метрик) и Triggers (триггеров).  

**Место для скриншота 4:** добавление хоста  

---

### 5. Проверка сбора данных (CPU, RAM, сеть)
Создаем нагрузку на процессор для проверки метрик:

```bash
sudo apt install stress
stress --cpu 1 --timeout 60
```

Проверяем, что в Dashboard отображается график CPU, памяти и сети.

> **Пояснение:**  
> - Items — это отдельные метрики (CPU, RAM, Disk, Network), которые собирает Zabbix.  
> - Graphs визуализируют данные.  

**Место для скриншота 5:** график CPU под нагрузкой  

---

### 6. Настройка оповещения (триггер + действие)
Создаем триггер:  
- Name: `High CPU usage on jenia-desktop`  
- Expression: `{jenia-desktop:system.cpu.util.last()}>80`  
- Severity: `High`  

> **Пояснение:**  
> Triggers позволяют Zabbix уведомлять администратора при критических событиях.  
> Action log фиксирует все срабатывания триггеров.  

**Место для скриншота 6:** триггер High CPU usage  

---

### 7. Создание персональной панели мониторинга (Dashboard)
В интерфейсе Zabbix создаем Dashboard:  
- Добавляем виджеты с графиками CPU, RAM, сети  
- Настраиваем обновление каждые 10 секунд  
- Можно визуально отслеживать состояние хоста  

**Место для скриншота 7:** Dashboard с графиками  

---

## Контрольные вопросы

1. **Какова роль основных компонентов Zabbix (Server, Agent, Proxy, Database, Frontend)?**  
- **Server:** собирает и обрабатывает данные.  
- **Agent:** собирает метрики на удаленных хостах.  
- **Proxy:** промежуточный сборщик для удаленных сетей.  
- **Database:** хранит все метрики и конфигурации.  
- **Frontend:** веб-интерфейс для визуализации данных.  

2. **Как осуществляется связь между Zabbix Server и Zabbix Agent?**  
Связь может быть:  
- **Активная:** агент отправляет данные серверу.  
- **Пассивная:** сервер опрашивает агент по расписанию.  
В обоих случаях используется порт 10050 для связи.  

3. **Что такое Items и Triggers в Zabbix?**  
- **Items:** метрики, которые Zabbix собирает с хостов (CPU, RAM, Disk, Network).  
- **Triggers:** условия, при которых генерируются оповещения о проблемах (например, CPU > 80%).  

---

## Заключение
В ходе лабораторной работы я установил и настроил сервер Zabbix и агент на другой машине, добавил хост, настроил сбор метрик, создал триггер и визуализировал данные в Dashboard. Работа показала, как Zabbix позволяет мониторить состояние ИТ-инфраструктуры в реальном времени и своевременно реагировать на критические события.

**Места для скриншотов оставлены для добавления иллюстраций установки, настройки и графиков.**

